(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76777a38"],{2413:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"dashboard-post-table"}},[n("b-table",{attrs:{data:t.posts,paginated:"",hoverable:"","pagination-rounded":"",selected:t.selectedPost,"is-row-selectable":function(){return!0},loading:t.loading,"pagination-size":"is-small","per-page":t.itemsPerPage,total:t.totalCount,"backend-pagination":"","row-class":function(t,e){return"is-clickable row--middle"},"backend-sorting":""},on:{"update:selected":function(e){t.selectedPost=e},"page-change":t.onPageChanged,sort:t.onSort,click:t.onRowClicked},scopedSlots:t._u([{key:"empty",fn:function(){return[n("empty-state",{attrs:{"image-src":"https://res.cloudinary.com/dml8e1w0z/image/upload/v1618931250/oop-learning-helper/post_empty_state_xcrbog.png",text:"Không có bài viết nào"}})]},proxy:!0},{key:"footer",fn:function(){return[n("div",[n("span",{staticClass:"has-text-grey"},[t._v("Số lượng kết quả: ")]),n("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.totalCount))])])]},proxy:!0}])},[n("b-table-column",{attrs:{label:"ID",width:"40",numeric:"",centered:""},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[n("strong",[t._v(t._s(o.id))])]}}])}),n("b-table-column",{attrs:{label:"Tên bài viết",width:"300","cell-class":"is-align-items-center"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[n("router-link",{attrs:{to:t.$_getPostDetailView(o.post_id)}},[t._v(" "+t._s(o.post_title)+" ")])]}}])}),n("b-table-column",{attrs:{label:"Chủ đề",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v(" "+t._s(n.topic_title)+" ")]}}])}),n("b-table-column",{attrs:{label:"Nhãn dán",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[n("b-taglist",[t._l(o.tags.slice(0,2),(function(e){return n("b-tag",{key:e.id,staticClass:"is-tag",attrs:{type:"is-primary-dark",size:"is-small"}},[t._v(t._s(e.tag_value))])})),o.tags.length>2?n("b-tag",{attrs:{type:"is-primary-dark"}},[t._v(" ... ")]):t._e()],2)]}}])}),n("b-table-column",{attrs:{field:"created_date",label:"Ngày tạo",width:"100",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v(" "+t._s(n.created_date.toLocaleDateString("en-GB"))+" ")]}}])}),n("b-table-column",{attrs:{visible:t.isRowSelected,label:"",width:"auto"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[t.selectedPostId===o.id?[n("section",{staticClass:"tooltip-section",staticStyle:{"margin-top":"-4px","margin-bottom":"-6px"}},t._l(t.postFeatures,(function(e,o){return n("b-tooltip",{key:e.id,attrs:{label:e.tooltip,type:e.type}},[n("b-button",{attrs:{size:"is-small","icon-left":e.icon,type:e.type,outlined:e.outlined,rounded:""},on:{click:function(e){return e.stopPropagation(),t.postFeatureHandler[o](e)}}})],1)})),1)]:t._e()]}}])})],1),n("b-modal",{attrs:{scroll:"keep"},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[n("div",{staticClass:"card is-page-responsive py-6"},[n("post-preview",{attrs:{useUrl:!0,contentUrl:t.fileContentUrl}})],1)])],1)},a=[],s=n("2909"),i=n("5530"),r=n("1da1"),c=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("159b"),n("07ac"),n("25f0"),n("841c"),n("ac1f"),n("4de4"),n("d81d"),n("ed08")),l={NONE:{status:-1,title:"Chọn tất cả"},ACTIVE:{status:0,title:"Đã duyệt",icon:"check",type:"is-success"},PENDING_CREATE:{status:1,title:"Duyệt tạo",icon:"circle",type:"is-danger"},PENDING_UPDATE:{status:2,title:"Duyệt cập nhật",icon:"circle",type:"is-danger"},PENDING_DELETE:{status:3,title:"Duyệt xóa",icon:"circle",type:"is-danger"}},u={name:"PostTable",components:{"post-preview":function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([n.e("chunk-2a303700"),n.e("chunk-932ac754"),n.e("chunk-210ea2fa"),n.e("chunk-072e95f0"),n.e("chunk-2b9b9f99")]).then(n.bind(null,"2af9"));case 2:return t.abrupt("return",t.sent.PostPreview);case 3:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),"empty-state":function(){return n.e("chunk-01f92af0").then(n.bind(null,"86d8"))}},props:{filter:{type:Object,default:function(){return null}},search:{type:Boolean,default:function(){return!1}}},inject:["findPosts","deletePost"],model:{prop:"search",event:"table-search"},data:function(){return{itemsPerPage:6,totalCount:0,posts:[],postStatusIcons:{},postFeatures:[{icon:"eye",tooltip:"Xem",type:"is-primary",outlined:!0},{icon:"pen",tooltip:"Chỉnh sửa",type:"is-primary",outlined:!0},{icon:"trash-alt",tooltip:"Xóa bài viết",type:"is-danger",outlined:!1}],sorter:{sort_by:"time",order:-1},page:1,postFeatureHandler:[],showModal:!1,selectedPost:null,loading:!1,postStatuses:{}}},created:function(){var t=this;this.postFeatureHandler.push(this.onViewButtonClicked,this.onEditPostButtonClicked,this.onDeleteButtonClicked),Object.values(l).forEach((function(e){t.postStatuses[e.status.toString()]={title:e.title,icon:e.icon,type:e.type}})),this.$_loadAsyncData()},computed:{selectedPostId:function(){var t;return null===(t=this.selectedPost)||void 0===t?void 0:t.id},isRowSelected:function(){return null!==this.selectedPost},_search:{get:function(){return this.search},set:function(t){this.$emit("table-search",t)}},fileContentUrl:function(){var t,e;return null!==(t=null===(e=this.selectedPost)||void 0===e?void 0:e.content_file_url)&&void 0!==t?t:null}},watch:{search:function(t,e){t&&this.$_loadAsyncData()},posts:function(){this.selectedPost=null}},methods:{onRowClicked:function(t){t.id===this.selectedPostId&&(this.selectedPost=null)},onPageChanged:function(t){this.page=t,this.$_loadAsyncData()},onSort:function(t,e){this.sorter["sort_by"]=t,this.sorter.sort_order=e,this.$_loadAsyncData()},$_loadAsyncData:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.loading=!0,n=Object(i["a"])(Object(i["a"])({},t.filter),{},{post_status:"0"},t.sorter),t.findPosts({page:t.page,searchOptions:n}).then((function(e){var n=e.error,o=e.data;t.loading=!1,t._search=!1,n||t.$_updateData(o)}));case 3:case"end":return e.stop()}}),e)})))()},$_updateData:function(t){var e,n=t.total_count,o=t.results;this.totalCount=n,this.posts.length=0,(e=this.posts).push.apply(e,Object(s["a"])(o.map((function(t,e){return t.id=e+1,t.created_date=new Date(t.created_date),t}))))},onViewButtonClicked:function(){this.showModal=!0},onEditPostButtonClicked:function(){this.$router.push({name:"EditPost",params:{post_id:this.selectedPost.post_id}})},onDeleteButtonClicked:function(){var t,e=this,n=null===(t=this.selectedPost)||void 0===t?void 0:t.post_id;n&&this.$buefy.dialog.confirm({title:"Xóa bài viết",message:"Bạn chắc chắc muốn xóa bài viết ?",confirmText:"Đồng ý",cancelText:"Hủy bỏ",type:"is-danger",onConfirm:function(){setTimeout(function(){var t=this;this.loading=!0,this.deletePost(n).then((function(e){var n=e.error;t.loading=!1,n?c["e"].error(t.$buefy.toast,"Xóa bài viết thất bại"):(c["e"].success(t.$buefy.toast,"Xóa bài viết thành công"),t.$_loadAsyncData())}))}.bind(e),500)}})},$_removePostFromTable:function(t){this.posts=this.posts.filter((function(e){return e.post_id!==t})),this.totalCount--},$_getPostDetailView:function(t){return{name:"AdminPostDetail",params:{post_id:t}}}}},d=u,p=(n("cada"),n("2877")),f=Object(p["a"])(d,o,a,!1,null,"b5f43bf2",null);e["default"]=f.exports},"25f0":function(t,e,n){"use strict";var o=n("6eeb"),a=n("825a"),s=n("d039"),i=n("ad6d"),r="toString",c=RegExp.prototype,l=c[r],u=s((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),d=l.name!=r;(u||d)&&o(RegExp.prototype,r,(function(){var t=a(this),e=String(t.source),n=t.flags,o=String(void 0===n&&t instanceof RegExp&&!("flags"in c)?i.call(t):n);return"/"+e+"/"+o}),{unsafe:!0})},2909:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var o=n("6b75");function a(t){if(Array.isArray(t))return Object(o["a"])(t)}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("a630");function s(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}var i=n("06c5");function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return a(t)||s(t)||Object(i["a"])(t)||r()}},9550:function(t,e,n){},cada:function(t,e,n){"use strict";n("9550")}}]);
//# sourceMappingURL=chunk-76777a38.50141bd6.js.map