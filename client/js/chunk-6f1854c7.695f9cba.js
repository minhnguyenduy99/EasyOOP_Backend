(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f1854c7"],{"0798":function(e,t,n){},"910c":function(e,t,n){"use strict";n("0798")},affd:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.test?n("div",{attrs:{id:"test-detail-page"}},[n("div",{staticClass:"test-detail-container"},[n("div",{staticClass:"ha-vertical-layout-7"},[n("test-detail",{attrs:{test:e.test,state:e.state},on:{start:e.$on_testStarted}}),n("div",{staticClass:"card"},[n("div",{staticClass:"card-content"},[e.isOnProgress?n("sentence-panel",{attrs:{sentences:e.sentences,selectedOrder:e.selectedOrder,sentencesPerGroup:e.sentencesPerGroup,currentAnswerGroup:e.currentAnswerGroup,currentPage:e.currentPage,pageCount:e.pageCount}}):e.isFinished?n("sentence-panel",{attrs:{sentences:e.sentences,showAnswer:!0,selectedOrder:e.selectedOrder,sentencesPerGroup:e.sentencesPerGroup,currentAnswerGroup:e.currentAnswerGroup,currentPage:e.currentPage,pageCount:e.pageCount}}):e._e()],1)])],1),n("div",[n("div",{staticClass:"ha-vertical-layout-7",attrs:{id:"sticky-test-info"}},[e.isFinished?e.testResult?n("test-result-info",{attrs:{testResult:e.testResult,state:e.state,sessionId:e.sessionId,selectedOrder:e.selectedOrder},on:{"update:selectedOrder":function(t){e.selectedOrder=t},"update:selected-order":function(t){e.selectedOrder=t},"result-saved":function(t){e.resultSaved=!0}}}):e._e():n("test-session-info",{attrs:{test:e.test,state:e.state,selectedOrder:e.selectedOrder},on:{"update:selectedOrder":function(t){e.selectedOrder=t},"update:selected-order":function(t){e.selectedOrder=t}}})],1)])])]):e._e()},i=[],r=n("1da1"),a=n("5530"),o=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("99af"),n("2b0e")),u=n("2f62"),c=n("cc7d"),d={name:"TestDetailPage",components:{"test-detail":function(){return n.e("chunk-33990608").then(n.bind(null,"58e8"))},"test-session-info":function(){return n.e("chunk-1a40259a").then(n.bind(null,"1d3c"))},"test-result-info":function(){return Promise.all([n.e("chunk-785f9ee4"),n.e("chunk-75f57be6")]).then(n.bind(null,"0354"))},"sentence-panel":function(){return n.e("chunk-2d209b20").then(n.bind(null,"a9c5"))}},mixins:[Object(c["b"])(o["default"])],inject:["$p_loadPage"],metaInfo:function(){var e,t="Làm bài test: ".concat(null===(e=this.test)||void 0===e?void 0:e.title," - ").concat(this.$appConfig.VUE_APP_NAME);return{title:t,meta:[{property:"og:title",content:t},{property:"og:image",content:"https://res.cloudinary.com/dml8e1w0z/image/upload/v1625112588/oop-learning-helper/white_3_vwauzw.png"}]}},props:{testId:String,sessionId:{type:String,default:function(){return null}}},provide:function(){return{$_navigateToPage:this.$_navigatePage.bind(this)}},data:function(){return{TEST_SESSION_STATES:{INIT:0,ON_PROGRESS:1,FINISHED:2},SENTENCES_PER_PAGE:10,test:null,testResult:null,sentences:[],selectedOrder:null,routeTo:null,resultSaved:!1,isSentencePanelLoading:!1}},created:function(){var e=this;this.$_updateTest().then((function(){e.sessionId&&e.$_navigatePage(1)}))},mounted:function(){if(this.sessionId)return this.$on("session-ended",this.$_getTestResultBySession),void this.$endSession();this.$_registerWindowUnloadEvent(),this.$on("session-ended",this.$on_sessionEnd)},beforeDestroy:function(){this.$_unregisterWindowUnloadEvent()},beforeRouteLeave:function(e,t,n){this.routeTo||this.isLeavable?n():(this.routeTo=e,this.$_callDialogConfirmForRouteChange())},watch:{testId:function(){var e=this;this.state=this.TEST_SESSION_STATES.INIT,this.$_updateTest().then((function(){e.sessionId&&e.$_navigatePage(1)}))}},computed:Object(a["a"])(Object(a["a"])({},Object(u["c"])("VIEWER_TEST",["sentencesPerGroup","currentAnswerGroup","currentPage","pageCount","totalAnswers"])),{},{isLeavable:function(){return this.isOnInit||this.resultSaved||!!this.sessionId}}),methods:Object(a["a"])(Object(a["a"])({},Object(u["b"])("VIEWER_TEST",["getTestById","viewer_createTestResult","getTestResultBySessionId","navigateToPage"])),{},{$_updateTest:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",e.getTestById(e.testId).then((function(t){var n=t.error,s=t.data;n?e.$router.push({name:"PageNotFound"}):e.test=s})));case 1:case"end":return t.stop()}}),t)})))()},$_navigatePage:function(e){var t=this;return this.$p_loadPage(!0),this.navigateToPage({page:e}).then((function(e){t.$p_loadPage(!1);var n=e.error,s=e.data;if(!n){var i=s.results;t.sentences.length=0,t.sentences=i}}))},$on_testStarted:function(){this.$startSession(),this.$_navigatePage(1)},$on_sessionEnd:function(){var e=this;this.viewer_createTestResult({test_id:this.testId,results:this.totalAnswers,save:!1}).then((function(t){var n=t.error,s=t.data;if(!n){var i=s.data;e.testResult=i,e.$_navigatePage(1)}}))},$_getTestResultBySession:function(){var e=this;this.getTestResultBySessionId(this.sessionId).then((function(t){var n=t.error,s=t.data;if(n)e.$router.push({name:"PageNotFound"});else{var i=s.data;i.test_id!==e.testId&&e.$router.push({name:"Home"}),e.testResult=i}}))},$_registerWindowUnloadEvent:function(){window.addEventListener("beforeunload",this.$_setupConfirmDialog)},$_unregisterWindowUnloadEvent:function(){window.removeEventListener("beforeunload",this.$_setupConfirmDialog)},$_setupConfirmDialog:function(e){if(!this.isLeavable)return e.preventDefault(),e.returnValue="Bạn muốn rời trang này ?","Bạn muốn rời trang này ?"},$_callDialogConfirmForRouteChange:function(){var e=this;this.$buefy.dialog.confirm({title:"CHUYỂN TRANG",message:"Bạn còn đang trong tình trạng làm bài hoặc chưa lưu kết quả<br /><strong>Bạn chắc chắn muốn rời khỏi trang này ?</strong>",confirmText:"Rời trang",cancelText:"Ở lại",type:"is-danger",hasIcon:!0,onConfirm:function(){return e.$router.push(e.routeTo)},onCancel:function(){return e.routeTo=null}})}})},l=d,S=(n("910c"),n("2877")),h=Object(S["a"])(l,s,i,!1,null,"75c0dcd6",null);t["default"]=h.exports},cc7d:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i}));n("a9e3");var s=function(){return{inject:["$startSession","$endSession","TEST_SESSION_STATES"],props:{state:Number},computed:{isOnInit:function(){return this.state===this.TEST_SESSION_STATES.INIT},isOnProgress:function(){return this.state===this.TEST_SESSION_STATES.ON_PROGRESS},isFinished:function(){return this.state===this.TEST_SESSION_STATES.FINISHED}}}},i=function(e){return{provide:function(){return{$startSession:this.$startSession.bind(this),$endSession:this.$endSession.bind(this),TEST_SESSION_STATES:this.TEST_SESSION_STATES}},data:function(){return{TEST_SESSION_STATES:{INIT:0,ON_PROGRESS:1,FINISHED:2},state:0}},computed:{isOnInit:function(){return this.state===this.TEST_SESSION_STATES.INIT},isOnProgress:function(){return this.state===this.TEST_SESSION_STATES.ON_PROGRESS},isFinished:function(){return this.state===this.TEST_SESSION_STATES.FINISHED}},methods:{$getState:function(){return this.state},$startSession:function(){this.state=this.TEST_SESSION_STATES.ON_PROGRESS},$endSession:function(){this.state=this.TEST_SESSION_STATES.FINISHED,this.$emit("session-ended")}}}}}}]);
//# sourceMappingURL=chunk-6f1854c7.695f9cba.js.map